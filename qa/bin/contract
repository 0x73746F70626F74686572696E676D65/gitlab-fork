#!/usr/bin/env ruby
# frozen_string_literal: true

require 'rake'

host = ARGV.shift
ENV['CONTRACT_HOST'] ||= host

list = []

loop do
  keyword = ARGV.shift
  case keyword
  when '--mr'
    ENV['CONTRACT_MR'] ||= ARGV.shift
    list.push 'test:merge_request'
  else
    break
  end
end

app = Rake.application

Dir.chdir('contracts/provider') do
  app.init
  app.add_import 'Rakefile'
  app.load_rakefile

  list.each do |element|
    app[element].invoke
  end
end
