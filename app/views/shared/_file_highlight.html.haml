- offset = defined?(first_line_number) ? first_line_number : 1
- highlight = defined?(highlight_line) && highlight_line ? highlight_line - offset : nil
- file_line_blame = Feature.enabled?(:file_line_blame)

- if file_line_blame
  - blame_path = project_blame_path(@project, tree_join(@ref, blob.path))

- highlighted_blob = blob.present.highlight

#blob-content.file-content.code.js-syntax-highlight
  .line-numbers{ class: "gl-px-0!", data: { blame_path: blame_path } }
    - if blob.data.present?
      - highlighted_blob.lines.count.times do |index|
        - i = index + offset
        -# We're not using `link_to` because it is too slow once we get to thousands of lines.
        %a.file-line-num.diff-line-num{ class: ("js-line-links" if file_line_blame), href: "#L#{i}", id: "L#{i}", 'data-line-number' => i }
          = i

  .blob-content{ data: { blob_id: blob.id, path: blob.path, highlight_line: highlight, qa_selector: 'file_content' } }
    %pre.code.highlight
      %code
        = highlighted_blob
