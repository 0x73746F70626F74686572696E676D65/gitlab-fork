# frozen_string_literal: true

module Gitlab
  module Llm
    module Templates
      module Vulnerabilities
        class ResolveVulnerability < VulnerabilityTemplate
          def to_prompt
            return unless eligible_code?

            prompt
          end

          private

          def prompt
            <<~PROMPT
            The file "#{filename}" has this vulnerable code:

            ```
            #{vulnerable_code}
            ```

            It has the security vulnerability "#{title} - (#{identifiers})". Write code that fixes the vulnerability.
            PROMPT
          end
        end
      end
    end
  end
end
