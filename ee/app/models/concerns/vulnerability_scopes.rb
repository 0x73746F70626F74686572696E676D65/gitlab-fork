# frozen_string_literal: true

module VulnerabilityScopes
  extend ActiveSupport::Concern

  included do
    scope :for_projects, ->(project_ids, include_archived = false) do
      if include_archived
        where(project_id: project_ids)
      else
        joins(:project).merge(::Project.non_archived).where(project_id: project_ids)
      end
    end
  end
end
