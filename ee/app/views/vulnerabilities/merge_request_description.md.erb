<% if llm_patch.present? %>
<% if resolve_vulnerability_ai_gateway %>
## AI GENERATED MERGE REQUEST
The suggested code changes were generated by GitLab Duo Vulnerability resolution, an AI feature. Use this feature with caution. Before you apply the code changes, carefully review and test them, to ensure that they solve the vulnerability.

The large language model that generated the suggested code changes was provided with only the affected lines of code, and the vulnerability in that code. It is not aware of any functionality outside of this context.

Please see [our documentation](https://docs.gitlab.com/ee/user/application_security/vulnerabilities/#vulnerability-resolution) for more information about this feature.

<% else %>
## AI GENERATED PATCH

The suggested code changes were generated by GitLab Duo Vulnerability Resolution, an AI feature.  **Use this feature with caution.** Before you apply the code changes, carefully review and test them, to ensure that they solve the vulnerability, don't harm the functional behavior of your application or introduce new vulnerabilities.

The large language model that generated the suggested code changes was only provided with the affected lines of code, and the vulnerability in that code. It is not aware of any functionality outside of this context.

Please see [our documentation](https://docs.gitlab.com/ee/user/application_security/vulnerabilities/#vulnerability-resolution) for more information about this feature.  We'd love to hear [your feedback](https://gitlab.com/gitlab-org/gitlab/-/issues/435721) so we can improve on this feature as we work to bring it to general availability.

<% end %>
<% end %>
### Description:

<%= finding.description || finding.name %>

<% if vulnerability.severity.present? %>
* Severity: <%= vulnerability.severity %>
<% end %>
<% if vulnerability.confidence.present? %>
* Confidence: <%= vulnerability.confidence %>
<% end %>
<% if defined?(vulnerability.file) && vulnerability.file.present? %>
* Location: [<%= finding.location_text %>](<%= finding.location_link %>)
<% end %>

<% if vulnerability.solution.present? %>
### Solution:

<%= vulnerability.solution %>
<% end %>

<% if vulnerability.identifiers.present? %>
### Identifiers:

<% vulnerability.identifiers.each do |identifier| %>
<% if identifier[:url].present? %>
* [<%= identifier[:name] %>](<%= identifier[:url] %>)
<% else %>
* <%= identifier[:name] %>
<% end %>
<% end %>
<% end %>

<% if vulnerability.links.present? %>
### Links:

<% vulnerability.links.each do |link| %>
<% if link['name'].present? %>
* [<%= link['name'] %>](<%= link['url'] %>)
<% else %>
* <%= link['url'] %>
<% end %>
<% end %>
<% end %>
