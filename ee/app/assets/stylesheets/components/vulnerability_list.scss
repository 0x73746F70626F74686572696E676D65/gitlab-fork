.vulnerability-header {
  grid-gap: $gl-spacing-scale-4;
  // Mobile layout.
  grid-template-areas: 'title' 'description' 'buttons';

  // Desktop layout.
  @media (min-width: $breakpoint-md) {
    grid-template-areas: 'title buttons' 'description description';
    grid-template-columns: 1fr min-content;
  }

  .header-title {
    grid-area: title;
  }

  .header-description {
    grid-area: description;
  }

  .header-buttons {
    grid-area: buttons;
  }
}

.security-dashboard-filters {
  position: sticky;
  top: $calc-application-header-height;
  z-index: 1;
}

.vulnerability-list {
  --security-filter-height: 85px;

  isolation: isolate;

  @media (min-width: $breakpoint-sm) {
    .checkbox {
      padding-left: $gl-spacing-scale-4;
      padding-right: 0;
      // Width needs to be something other than auto for the column to shrink down to the content
      // width. The actual value needs to be less than the content, but not 0 (safari issue).
      width: 1px;

      // If the checkbox column is shown, reduce the padding of the column to the right of it.
      + td,
      + th {
        padding-left: $gl-spacing-scale-4;
      }
    }

    .detected {
      width: 9%;
    }

    .status {
      width: 8%;
    }

    .severity {
      width: 10%;
    }

    .description {
      max-width: 0;
    }

    .identifier {
      width: 16%;
    }

    .scanner {
      width: 10%;
    }

    .activity {
      width: 5%;
    }
  }

  // Due to position: sticky not being supported on Chrome (https://caniuse.com/#feat=css-sticky),
  // the property is assigned to the th element as a workaround
  thead th {
    // The !important works around https://github.com/bootstrap-vue/bootstrap-vue/pull/6371.
    position: sticky !important;
    border-top: 0;
    // The checkboxes use z-index: 1, so we need to place the headers higher so that the checkboxes
    // don't show on top of the headers when scrolling down.
    z-index: 2;
    top: calc(#{$calc-application-header-height} + var(--security-filter-height) + var(--selection-summary-height, 0px) + var(--group-by-selection-height, 0px));
    // Need to use an inset box-shadow here for the bottom border because position: sticky will hide
    // any borders once the table headers become sticky.
    box-shadow: inset 0 -1px $gray-100;
  }

  --selection-summary-container-height: 81px;
  --validation-error-height: 24px;
  --dismissal-error-height: 52px;
  --group-by-selection-container-height: 64px;
  --advanced-filtering-container-height: 48px; // 36px container height, 12px margin top
  --advanced-filtering-container-height-without-group-by: 36px;

  .below-selection-summary th {
    --selection-summary-height: var(--selection-summary-container-height);

    :has(.selection-summary.with-validation-error) & {
      --selection-summary-height: calc(var(--selection-summary-container-height) + var(--validation-error-height));
    }

    :has(.selection-summary.with-dismissal-error) & {
      --selection-summary-height: calc(var(--selection-summary-container-height) + var(--dismissal-error-height));
    }

    :has(.selection-summary.with-validation-error.with-dismissal-error) & {
      --selection-summary-height: calc(var(--selection-summary-container-height) + var(--dismissal-error-height) + var(--validation-error-height));
    }
  }

  .has-group-by & {
    --group-by-selection-height: var(--group-by-selection-container-height);
  }

  .has-advanced-filtering & {
    --security-filter-height: var(--advanced-filtering-container-height-without-group-by);
  }

  .has-advanced-filtering.has-group-by & {
    --security-filter-height: var(--advanced-filtering-container-height);
  }

  tr:hover .vulnerability-title {
    text-decoration: underline;
  }
}

