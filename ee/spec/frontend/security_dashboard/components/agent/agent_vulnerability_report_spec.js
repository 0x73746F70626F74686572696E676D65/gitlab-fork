import { shallowMount } from '@vue/test-utils';
import VulnerabilityListGraphql from 'ee/security_dashboard/components/shared/vulnerability_report/vulnerability_list_graphql.vue';
import VulnerabilityFilters from 'ee/security_dashboard/components/shared/vulnerability_report/vulnerability_filters.vue';
import AgentVulnerabilityReport from 'ee/security_dashboard/components/agent/agent_vulnerability_report.vue';

describe('Agent vulnerability report component', () => {
  let wrapper;

  const provide = { agentName: 'primary-agent', projectPath: '/path/to/project/' };

  const createWrapper = () => {
    wrapper = shallowMount(AgentVulnerabilityReport, { provide });
  };

  const findVulnerabilityFilters = () => wrapper.findComponent(VulnerabilityFilters);
  const findVulnerabilityList = () => wrapper.findComponent(VulnerabilityListGraphql);

  afterEach(() => {
    wrapper.destroy();
  });

  it('renders', () => {
    createWrapper();

    expect(findVulnerabilityFilters().exists()).toBe(true);
    expect(findVulnerabilityList().exists()).toBe(true);
  });
});
